<!DOCTYPE html>
<html>
<head>
    <title>资料编辑</title>
    <meta name="keywords" content=""/>
    <meta name="description" content="">
    <include file="public@head"/>
    <style type="text/css">
        .pic-list li {
            margin-bottom: 5px;
        }
    </style>
    <script type="text/html" id="photos-item-tpl">
        <li id="saved-image{id}">
            <input id="photo-{id}" type="hidden" name="calc[bottom_photos][]" value="{filepath}">
            <input class="form-control" id="photo-{id}-name" type="text" name="calc[bottom_photos_name][]" value="{name}"
                   style="width: 200px;" title="图片名称">
            <img id="photo-{id}-preview" src="{url}" style="height:36px;width: 36px;"
                 onclick="imagePreviewDialog(this.src);">
            <a href="javascript:uploadOneImage('图片上传','#photo-{id}');">替换</a>
            <a href="javascript:(function(){$('#saved-image{id}').remove();})();">移除</a>
        </li>
    </script>
</head>
<body class="body-white" id="top">
<include file="public@dashboardtopnav" />

<div class="container tc-main">
    <div class="row">
        <div class="col-md-3">
            <include file="public@dashboardnav" />
        </div>
        <div class="col-md-9">
            <div class="tabs">
                <ul class="nav nav-tabs">
                    <li class="active"><a href="#A" data-toggle="tab">资料设置</a></li>
                    <li><a href="#B" data-toggle="tab">相册设置</a></li>
                </ul><br />
                <form class="form-horizontal js-ajax-form margin-top-20" role="form" action="{:url('dashboard/Profile/editPost')}" method="post">
                    <fieldset>
                        <div class="tabbable">
                            <div class="tab-content">
                                <div class="tab-pane active" id="A">

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label"><span class="form-required">*</span>公司LOGO</label>
                                        <div class="col-md-6 col-sm-10">
                                            <input type="hidden" name="post[top_photo]" id="thumbnail" value="{$aa|default=''}">
                                            <a href="javascript:uploadOneImage('图片上传','#thumbnail');">
                                                <if condition="empty('')">
                                                    <img src="__TMPL__/public/assets/images/default-thumbnail.png"
                                                         id="thumbnail-preview"
                                                         width="135" style="cursor: pointer"/>
                                                    <else />
                                                    <img src="{:cmf_get_image_preview_url('')}"
                                                         id="thumbnail-preview"
                                                         width="135" style="cursor: pointer"/>
                                                </if>

                                            </a>
                                            <input type="button" class="btn btn-sm btn-cancel-thumbnail" value="取消图片">
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="input-nickname" class="col-sm-2 control-label"><span class="form-required">*</span>公司名称</label>
                                        <div class="col-md-6 col-sm-10">
                                            <input type="text" class="form-control" id="input-nickname" name="post[title]" value="{$aa|default=''}" required />
                                        </div>
                                    </div>
                                    <div class="form-group">
                                        <label for="input-tel" class="col-sm-2 control-label"><span class="form-required">*</span>公司电话</label>
                                        <div class="col-md-6 col-sm-10">
                                            <input type="text" class="form-control" id="input-tel" name="post[title]" value="{$aa|default=''}" required />
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="input-address" class="col-sm-2 control-label"><span class="form-required">*</span>地址信息</label>
                                        <div class="col-md-6 col-sm-10">
                                            <input type="text" class="form-control" id="input-address" name="post[title]" value="{$aa|default=''}" required />
                                        </div>
                                        <input type="hidden" name="location" value="" />
                                        <a href="javascript:;" class="btn btn-default">定位</a>

                                    </div>

                                    <div class="form-group">
                                        <label class="col-sm-2 control-label"> </label>
                                        <div class="col-md-6 col-sm-10"><a href="javascript:;">添加分店地址</a> </div>
                                    </div>

                                    <div class="form-group">
                                        <label for="input-address" class="col-sm-2 control-label">公司简介</label>
                                        <div class="col-md-10 col-sm-10">
                                            <script type="text/plain" id="content" name="post[content]" style="height:300px;"></script>
                                        </div>
                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-offset-2 col-sm-10">
                                            <button type="submit" class="btn btn-primary js-ajax-submit" data-refresh="1">{:lang('SAVE')}</button>
                                        </div>
                                    </div>
                                </div>
                                <div class="tab-pane" id="B">
                                    <div class="form-group">
                                        <label class="col-sm-2 control-label">公司相册</label>
                                        <div class="col-md-6 col-sm-10">
                                            <ul id="photos" class="pic-list list-unstyled form-inline">

                                                <notempty name="calc.bottom_photos">
                                                    <foreach name="calc.bottom_photos" item="vo">
                                                        <php>$img_url=cmf_get_image_preview_url($vo);</php>
                                                        <li id="saved-image{$key}">
                                                            <input id="photo-{$key}" type="hidden" name="calc[bottom_photos][]"
                                                                   value="{$vo}">
                                                            <input class="form-control" id="photo-{$key}-name" type="text"
                                                                   name="calc[bottom_photos_name][]"
                                                                   value="{$calc.bottom_photos_name[$key]|default=''}" style="width: 200px;" title="图片名称">
                                                            <img id="photo-{$key}-preview"
                                                                 src="{:cmf_get_image_preview_url($vo)}"
                                                                 style="height:36px;width: 36px;"
                                                                 onclick="parent.imagePreviewDialog(this.src);">
                                                            <a href="javascript:uploadOneImage('图片上传','#photo-{$key}');">替换</a>
                                                            <a href="javascript:(function(){$('#saved-image{$key}').remove();})();">移除</a>
                                                        </li>
                                                    </foreach>
                                                </notempty>

                                            </ul>
                                            <a href="javascript:uploadMultiImage('图片上传','#photos','photos-item-tpl');"
                                               class="btn btn-default btn-lg">选择图片</a>
                                        </div>

                                    </div>

                                    <div class="form-group">
                                        <div class="col-sm-offset-2 col-sm-10">
                                            <button type="submit" class="btn btn-primary js-ajax-submit" data-refresh="1">{:lang('SAVE')}</button>
                                        </div>
                                    </div>
                                </div>

                            </div>
                        </div>
                    </fieldset>
                </form>
            </div>
        </div>
    </div>
    <include file="public@footer" />
</div>
<!-- /container -->
<include file="public@dashboardscripts" />
<script type="text/javascript">
    //编辑器路径定义
    var editorURL = GV.WEB_ROOT;
</script>
<script type="text/javascript" src="__STATIC__/js/ueditor/ueditor.config.js"></script>
<script type="text/javascript" src="__STATIC__/js/ueditor/ueditor.all.min.js"></script>
<script>

    var toolbars={
        toolbars: [[
            'undo','redo','bold','italic','underline','subscript','superscript','removeformat','|',
            'fontfamily','fontsize','forecolor','backcolor','|',
            'justifyleft','justifyright','justifycenter','justifyjustify','|',
            'simpleupload','insertimage','|',
            'fullscreen'
        ]],autoHeightEnabled:false,elementPathEnabled:false
    };
    editorcontent = new baidu.editor.ui.Editor(toolbars);
    editorcontent.render('content');
    try {
        editorcontent.sync();
    } catch (err) {
    }

    $('.btn-cancel-thumbnail').click(function () {
        $('#thumbnail-preview').attr('src', '__TMPL__/public/assets/images/default-thumbnail.png');
        $('#thumbnail').val('');
    });

</script>
</body>
</html>